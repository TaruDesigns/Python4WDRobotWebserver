let StickStatus={xPosition:0,yPosition:0,x:0,y:0,cardinalDirection:"C"};var JoyStick=function(t,e,i){var o=void 0===(e=e||{}).title?"joystick":e.title,n=void 0===e.width?0:e.width,a=void 0===e.height?0:e.height,r=void 0===e.internalFillColor?"#00AA00":e.internalFillColor,s=void 0===e.internalLineWidth?2:e.internalLineWidth,c=void 0===e.internalStrokeColor?"#003300":e.internalStrokeColor,$=void 0===e.externalLineWidth?2:e.externalLineWidth,d=void 0===e.externalStrokeColor?"#008000":e.externalStrokeColor,u=void 0===e.autoReturnToCenter||e.autoReturnToCenter;i=i||function(t){};var h=document.getElementById(t);h.style.touchAction="none";var S=document.createElement("canvas");S.id=o,0===n&&(n=h.clientWidth),0===a&&(a=h.clientHeight),S.width=n,S.height=a,h.appendChild(S);var f=S.getContext("2d"),l=0,k=2*Math.PI,_=(S.width-(S.width/2+10))/2,g=_+5,x=_+30,v=S.width/2,P=S.height/2,C=S.width/10,p=-1*C,y=S.height/10,w=-1*y,L=v,F=P;function m(){f.beginPath(),f.arc(v,P,x,0,k,!1),f.lineWidth=$,f.strokeStyle=d,f.stroke()}function E(){f.beginPath(),L<_&&(L=g),L+_>S.width&&(L=S.width-g),F<_&&(F=g),F+_>S.height&&(F=S.height-g),f.arc(L,F,_,0,k,!1);var t=f.createRadialGradient(v,P,5,v,P,200);t.addColorStop(0,r),t.addColorStop(1,c),f.fillStyle=t,f.fill(),f.lineWidth=s,f.strokeStyle=c,f.stroke()}function W(t){l=1}function T(t){l=1}function D(){let t="",e=L-v,i=F-P;return i>=w&&i<=y&&(t="C"),i<w&&(t="N"),i>y&&(t="S"),e<p&&("C"===t?t="W":t+="W"),e>C&&("C"===t?t="E":t+="E"),t}"ontouchstart"in document.documentElement?(S.addEventListener("touchstart",W,!1),S.addEventListener("touchmove",function t(e){1===l&&e.targetTouches[0].target===S&&(L=e.targetTouches[0].pageX,F=e.targetTouches[0].pageY,"BODY"===S.offsetParent.tagName.toUpperCase()?(L-=S.offsetLeft,F-=S.offsetTop):(L-=S.offsetParent.offsetLeft,F-=S.offsetParent.offsetTop),f.clearRect(0,0,S.width,S.height),m(),E(),StickStatus.xPosition=L,StickStatus.yPosition=F,StickStatus.x=(100*((L-v)/g)).toFixed(),StickStatus.y=(-(100*((F-P)/g)*1)).toFixed(),StickStatus.cardinalDirection=D(),i(StickStatus))},!1),S.addEventListener("touchend",function t(e){l=0,u&&(L=v,F=P),f.clearRect(0,0,S.width,S.height),m(),E(),StickStatus.xPosition=L,StickStatus.yPosition=F,StickStatus.x=(100*((L-v)/g)).toFixed(),StickStatus.y=(-(100*((F-P)/g)*1)).toFixed(),StickStatus.cardinalDirection=D(),i(StickStatus)},!1)):(S.addEventListener("mousedown",T,!1),S.addEventListener("mousemove",function t(e){1===l&&(L=e.pageX,F=e.pageY,"BODY"===S.offsetParent.tagName.toUpperCase()?(L-=S.offsetLeft,F-=S.offsetTop):(L-=S.offsetParent.offsetLeft,F-=S.offsetParent.offsetTop),f.clearRect(0,0,S.width,S.height),m(),E(),StickStatus.xPosition=L,StickStatus.yPosition=F,StickStatus.x=(100*((L-v)/g)).toFixed(),StickStatus.y=(-(100*((F-P)/g)*1)).toFixed(),StickStatus.cardinalDirection=D(),i(StickStatus))},!1),S.addEventListener("mouseup",function t(e){l=0,u&&(L=v,F=P),f.clearRect(0,0,S.width,S.height),m(),E(),StickStatus.xPosition=L,StickStatus.yPosition=F,StickStatus.x=(100*((L-v)/g)).toFixed(),StickStatus.y=(-(100*((F-P)/g)*1)).toFixed(),StickStatus.cardinalDirection=D(),i(StickStatus)},!1)),m(),E(),this.GetWidth=function(){return S.width},this.GetHeight=function(){return S.height},this.GetPosX=function(){return L},this.GetPosY=function(){return F},this.GetX=function(){return(100*((L-v)/g)).toFixed()},this.GetY=function(){return(-(100*((F-P)/g)*1)).toFixed()},this.GetDir=function(){return D()}};